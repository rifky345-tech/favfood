<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pembayaran - FavFood</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/icon.css" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
      }

      .payment-method {
        transition: all 0.3s ease;
      }
      .payment-method:hover {
        transform: translateY(-2px);
      }
      .payment-method.active {
        border-color: #05113b;
        background-color: #f0f4ff;
      }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#05113b",
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-gray-50">
    <header class="bg-white shadow-md sticky top-0 z-50">
      <div class="container mx-auto px-4 py-4 flex items-center justify-between">
        <a href="checkout.html" class="text-sm text-primary hover:underline flex items-center space-x-1">
          <i class="fas fa-arrow-left text-lg"></i>
        </a>
        <p class="absolute left-1/2 -translate-x-1/2 font-bold text-lg text-primary">
          Pembayaran
        </p>
      </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-4xl">
      <div id="empty-state" class="hidden">
        <div class="bg-white rounded-lg shadow-md p-6 flex flex-col items-center text-center">
          <i class="fas fa-shopping-cart text-4xl text-black mb-4"></i>
          <p class="text-black mb-4">Belum ada pesanan untuk dibayar.</p>
          <a href="index.html" class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-opacity-90 transition">
            Kembali ke Menu
          </a>
        </div>
      </div>

      <div id="payment-content" class="space-y-6 hidden">
        <div class="bg-white rounded-lg shadow-md p-4 md:p-6">

          <h3 class="text-lg font-semibold text-black mb-4">Ringkasan Pesanan</h3>

          <!-- GARIS PEMISAH BARU -->
          <hr class="border-t-2 border-gray-300 mb-4">

          <div class="space-y-4 mb-6">
            <div>
              <label for="tipe-pesanan" class="text-sm font-medium text-black mb-2">
                Tipe Pesanan
              </label>
              <select
                id="tipe-pesanan"
                name="tipe-pesanan"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white"
              >
                <option value="Dine In">Dine In</option>
                <option value="Take Away">Take Away</option>
              </select>
            </div>

            <div>
              <label for="customer-name" class="block text-sm font-medium text-black mb-2">
                Nama
              </label>
              <input
                type="text"
                id="customer-name"
                name="customer-name"
                placeholder="Masukkan nama lengkap"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
              />
            </div>

            <div>
              <label for="customer-phone" class="block text-sm font-medium text-black mb-2">
                Nomor Telepon
              </label>
              <input
                type="tel"
                id="customer-phone"
                name="customer-phone"
                placeholder="Masukkan nomor telepon"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
              />
            </div>
          </div>

          <!-- GARIS PEMISAH BAGIAN BAWAH (ganti border-t lama) -->
          <hr class="border-t border-gray-300 mb-4">

          <h3 class="text-lg font-semibold text-black mb-4">Pilih Metode Pembayaran</h3>

          <div class="space-y-3">
            <div class="payment-method border-2 border-gray-200 rounded-lg p-4 cursor-pointer"
              onclick="selectPaymentMethod('ewallet')">
              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                  <i class="fa-solid fa-qrcode text-2xl text-primary"></i>
                  <div><p class="font-semibold text-black">QRIS</p></div>
                </div>
                <i id="icon-ewallet" class="fas fa-circle text-black text-lg hidden"></i>
                <i id="icon-ewallet-check" class="fas fa-check-circle text-primary text-lg hidden"></i>
              </div>
            </div>

            <div class="payment-method border-2 border-gray-200 rounded-lg p-4 cursor-pointer"
              onclick="selectPaymentMethod('cod')">
              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                  <i class="fas fa-money-bill-wave text-2xl text-primary"></i>
                  <div><p class="font-semibold text-black">Cash</p></div>
                </div>
                <i id="icon-cod" class="fas fa-circle text-black text-lg hidden"></i>
                <i id="icon-cod-check" class="fas fa-check-circle text-primary text-lg hidden"></i>
              </div>
            </div>
          </div>

        </div>

        <div class="flex flex-col md:flex-row gap-3">
          <a href="checkout.html" class="w-full md:w-auto text-center border border-primary text-primary px-6 py-3 rounded-lg text-sm font-semibold hover:bg-gray-50 transition">
            Kembali
          </a>
          <button
            id="confirm-payment-btn"
            onclick="confirmPayment()"
            disabled
            class="w-full md:flex-1 bg-gray-300 text-black px-6 py-3 rounded-lg text-sm font-semibold transition cursor-not-allowed"
          >
            <i class="fas fa-lock mr-2"></i>
            Konfirmasi Pembayaran
          </button>
        </div>
      </div>
    </main>

    <script>
      let selectedPaymentMethod = null;
      let orderData = null;

      function formatRupiah(number) {
        return "Rp " + Number(number).toLocaleString("id-ID");
      }

      function loadOrder() {
        const rawCart = localStorage.getItem("favfood_cart");
        let cart = [];
        if (rawCart) {
          try {
            const parsed = JSON.parse(rawCart);
            if (Array.isArray(parsed)) {
              cart = parsed;
            }
          } catch (e) {
            console.error("Gagal membaca data keranjang", e);
          }
        }

        const emptyState = document.getElementById("empty-state");
        const paymentContent = document.getElementById("payment-content");

        if (!cart.length) {
          emptyState.classList.remove("hidden");
          paymentContent.classList.add("hidden");
          return;
        }

        emptyState.classList.add("hidden");
        paymentContent.classList.remove("hidden");

        orderData = cart;
      }

      function selectPaymentMethod(method) {
        selectedPaymentMethod = method;

        document.querySelectorAll(".payment-method").forEach((el) => {
          el.classList.remove("active");
        });

        document.querySelectorAll("[id^='icon-']").forEach((el) => {
          el.classList.add("hidden");
        });

        const selectedEl = event.currentTarget;
        selectedEl.classList.add("active");

        const checkIcon = document.getElementById(`icon-${method}-check`);
        if (checkIcon) checkIcon.classList.remove("hidden");

        const confirmBtn = document.getElementById("confirm-payment-btn");
        confirmBtn.disabled = false;
        confirmBtn.classList.remove("bg-gray-300", "text-black", "cursor-not-allowed");
        confirmBtn.classList.add("bg-primary", "text-white", "hover:bg-opacity-90", "cursor-pointer");
      }

      function confirmPayment() {
        if (!selectedPaymentMethod) {
          alert("Silakan pilih metode pembayaran terlebih dahulu.");
          return;
        }

        if (!orderData || !orderData.length) {
          alert("Tidak ada pesanan untuk dikonfirmasi.");
          return;
        }

        alert("Pembayaran berhasil! Terima kasih atas pesanan Anda.");
        window.location.href = "index.html";
      }

      document.addEventListener("DOMContentLoaded", loadOrder);
    </script>
  </body>
</html>
